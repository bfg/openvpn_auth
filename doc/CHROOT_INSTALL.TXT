#
# This is ad-hoc document how to chroot openvpn and openvpn_authd.
# 
# However, you don't need to do this, or you can only chroot openvpn and not
# openvpn_authd, but the best way is to chroot both of them (openvpn_authd was
# designed to run in chroot from scratch)
#

1. Create openvpn chroot directory (see OPENVPN_CHROOT_STRUCTURE.TXT)

2. Create openvpn_authd chroot structure (see OPENVPN_AUTHD_CHROOT_STRUCTURE.TXT)

3. Configure your syslogd (or even better, syslog-ng) to put listening sockets in *BOTH* chroots

4. Restart syslogd :)

5. Compile openvpn_authc statically (cd c && make static)

6. Reconfigure your openvpn to chroot (see samples/openvpn-server-chroot.conf)

7. Reconfigure openvpn_authd to put listening socket to openvpn chroot
   (you don't need to do this if openvpn_authd is listening at tcp address)

8. Edit <OPENVPN_CHROOT>/etc/openvpn_authc.conf and set directive hostname

9. Put statically compiled openvpn_authc binary into <OPENVPN_CHROOT>/bin

10. Put /bin/sh into <OPENVPN_CHROOT>/bin and /bin/sh linked libraries into <OPENVPN_CHROOT>/lib(64)

	# ldd ../bin/sh
        libtermcap.so.2 => /lib64/libtermcap.so.2 (0x00002b636bf5c000)
        libdl.so.2 => /lib64/libdl.so.2 (0x00002b636c05f000)
        libc.so.6 => /lib64/libc.so.6 (0x00002b636c163000)
        /lib64/ld-linux-x86-64.so.2 (0x00002b636be3c000)
	

11. Restart openvpn and openvpn_authd && test configuration

12. Enjoy the life :)

# EOF